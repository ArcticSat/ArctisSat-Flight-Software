/*
 * deployables.c
 *
 *  Created on: Mar. 3, 2023
 *      Author: Jayden McKoy
 */

//-------------------------------------------------------------------------------------------------------------------------------------------------------------
// INCLUDES
//-------------------------------------------------------------------------------------------------------------------------------------------------------------
#include "application/sc_deployment.h"
#include "drivers/subsystems/eps_driver.h"

#include "FreeRTOS.h"
#include "task.h"

//-------------------------------------------------------------------------------------------------------------------------------------------------------------
// DEFINITIONS AND MACROS
//-------------------------------------------------------------------------------------------------------------------------------------------------------------
#define DEPLOYMENT_WAIT_TIME_SECONDS 30
//-------------------------------------------------------------------------------------------------------------------------------------------------------------
// STRUCTS AND STRUCT TYPEDEFS
//-------------------------------------------------------------------------------------------------------------------------------------------------------------

//-------------------------------------------------------------------------------------------------------------------------------------------------------------
// ENUMS AND ENUM TYPEDEFS
//-------------------------------------------------------------------------------------------------------------------------------------------------------------

//-------------------------------------------------------------------------------------------------------------------------------------------------------------
// VARIABLES
//-------------------------------------------------------------------------------------------------------------------------------------------------------------

//-------------------------------------------------------------------------------------------------------------------------------------------------------------
// FUNCTIONS
//-------------------------------------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------------------------------------
void InitiateSpacecraftDeployment(void)
{
	// Deploy solar arrays
	setLoadSwitch(LS_DPL_S, SWITCH_ON);
	vTaskDelay(pdMS_TO_TICKS(DEPLOYMENT_WAIT_TIME_SECONDS));
	setLoadSwitch(LS_DPL_S, SWITCH_OFF);
	// Deploy antenna (shuts off automatically)
	setLoadSwitch(LS_DPL_A, SWITCH_ON);
	vTaskDelay(pdMS_TO_TICKS(DEPLOYMENT_WAIT_TIME_SECONDS));
	setLoadSwitch(LS_DPL_A, SWITCH_OFF);
}

